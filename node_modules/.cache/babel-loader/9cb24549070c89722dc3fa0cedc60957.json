{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport * as React from 'react';\nimport { useState, useEffect } from 'react';\nimport * as PropTypes from 'prop-types';\nimport useMapControl, { mapControlPropTypes } from '../components/use-map-control';\nvar pixelRatio = typeof window !== 'undefined' && window.devicePixelRatio || 1;\nvar propTypes = Object.assign({}, mapControlPropTypes, {\n  redraw: PropTypes.func.isRequired\n});\nvar defaultProps = {\n  captureScroll: false,\n  captureDrag: false,\n  captureClick: false,\n  captureDoubleClick: false,\n  capturePointerMove: false\n};\nfunction CanvasOverlay(props) {\n  var _useMapControl = useMapControl(props),\n    context = _useMapControl.context,\n    containerRef = _useMapControl.containerRef;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    ctx = _useState2[0],\n    setDrawingContext = _useState2[1];\n  useEffect(function () {\n    setDrawingContext(containerRef.current.getContext('2d'));\n  }, []);\n  var viewport = context.viewport,\n    isDragging = context.isDragging;\n  if (ctx) {\n    ctx.save();\n    ctx.scale(pixelRatio, pixelRatio);\n    props.redraw({\n      width: viewport.width,\n      height: viewport.height,\n      ctx: ctx,\n      isDragging: isDragging,\n      project: viewport.project,\n      unproject: viewport.unproject\n    });\n    ctx.restore();\n  }\n  return React.createElement(\"canvas\", {\n    ref: containerRef,\n    width: viewport.width * pixelRatio,\n    height: viewport.height * pixelRatio,\n    style: {\n      width: \"\".concat(viewport.width, \"px\"),\n      height: \"\".concat(viewport.height, \"px\"),\n      position: 'absolute',\n      left: 0,\n      top: 0\n    }\n  });\n}\nCanvasOverlay.propTypes = propTypes;\nCanvasOverlay.defaultProps = defaultProps;\nexport default CanvasOverlay;","map":{"version":3,"names":["React","useState","useEffect","PropTypes","useMapControl","mapControlPropTypes","pixelRatio","window","devicePixelRatio","propTypes","Object","assign","redraw","func","isRequired","defaultProps","captureScroll","captureDrag","captureClick","captureDoubleClick","capturePointerMove","CanvasOverlay","props","_useMapControl","context","containerRef","_useState","_useState2","_slicedToArray","ctx","setDrawingContext","current","getContext","viewport","isDragging","save","scale","width","height","project","unproject","restore","createElement","ref","style","concat","position","left","top"],"sources":["../../../src/overlays/canvas-overlay.js"],"sourcesContent":["// Copyright (c) 2015 Uber Technologies, Inc.\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport * as React from 'react';\nimport {useState, useEffect} from 'react';\nimport * as PropTypes from 'prop-types';\nimport useMapControl, {mapControlPropTypes} from '../components/use-map-control';\n\n/* global window */\nconst pixelRatio = (typeof window !== 'undefined' && window.devicePixelRatio) || 1;\n\nconst propTypes = Object.assign({}, mapControlPropTypes, {\n  redraw: PropTypes.func.isRequired\n});\n\nconst defaultProps = {\n  captureScroll: false,\n  captureDrag: false,\n  captureClick: false,\n  captureDoubleClick: false,\n  capturePointerMove: false\n};\n\nfunction CanvasOverlay(props) {\n  const {context, containerRef} = useMapControl(props);\n  const [ctx, setDrawingContext] = useState(null);\n\n  useEffect(() => {\n    setDrawingContext(containerRef.current.getContext('2d'));\n  }, []);\n\n  const {viewport, isDragging} = context;\n\n  if (ctx) {\n    ctx.save();\n    ctx.scale(pixelRatio, pixelRatio);\n\n    props.redraw({\n      width: viewport.width,\n      height: viewport.height,\n      ctx,\n      isDragging,\n      project: viewport.project,\n      unproject: viewport.unproject\n    });\n\n    ctx.restore();\n  }\n\n  return (\n    <canvas\n      ref={containerRef}\n      width={viewport.width * pixelRatio}\n      height={viewport.height * pixelRatio}\n      style={{\n        width: `${viewport.width}px`,\n        height: `${viewport.height}px`,\n        position: 'absolute',\n        left: 0,\n        top: 0\n      }}\n    />\n  );\n}\n\nCanvasOverlay.propTypes = propTypes;\nCanvasOverlay.defaultProps = defaultProps;\n\nexport default CanvasOverlay;\n"],"mappings":";AAoBA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAAQC,QAAR,EAAkBC,SAAlB,QAAkC,OAAlC;AACA,OAAO,KAAKC,SAAZ,MAA2B,YAA3B;AACA,OAAOC,aAAP,IAAuBC,mBAAvB,QAAiD,+BAAjD;AAGA,IAAMC,UAAU,GAAI,OAAOC,MAAP,KAAkB,WAAlB,IAAiCA,MAAM,CAACC,gBAAzC,IAA8D,CAAjF;AAEA,IAAMC,SAAS,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBN,mBAAlB,EAAuC;EACvDO,MAAM,EAAET,SAAS,CAACU,IAAV,CAAeC;AADgC,CAAvC,CAAlB;AAIA,IAAMC,YAAY,GAAG;EACnBC,aAAa,EAAE,KADI;EAEnBC,WAAW,EAAE,KAFM;EAGnBC,YAAY,EAAE,KAHK;EAInBC,kBAAkB,EAAE,KAJD;EAKnBC,kBAAkB,EAAE;AALD,CAArB;AAQA,SAASC,aAATA,CAAuBC,KAAvB,EAA8B;EAAA,IAAAC,cAAA,GACInB,aAAa,CAACkB,KAAD,CADjB;IACrBE,OADqB,GAAAD,cAAA,CACrBC,OADqB;IACZC,YADY,GAAAF,cAAA,CACZE,YADY;EAAA,IAAAC,SAAA,GAEKzB,QAAQ,CAAC,IAAD,CAFb;IAAA0B,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAErBG,GAFqB,GAAAF,UAAA;IAEhBG,iBAFgB,GAAAH,UAAA;EAI5BzB,SAAS,CAAC,YAAM;IACd4B,iBAAiB,CAACL,YAAY,CAACM,OAAb,CAAqBC,UAArB,CAAgC,IAAhC,CAAD,CAAjB;EACD,CAFQ,EAEN,EAFM,CAAT;EAJ4B,IAQrBC,QARqB,GAQGT,OARH,CAQrBS,QARqB;IAQXC,UARW,GAQGV,OARH,CAQXU,UARW;EAU5B,IAAIL,GAAJ,EAAS;IACPA,GAAG,CAACM,IAAJ;IACAN,GAAG,CAACO,KAAJ,CAAU9B,UAAV,EAAsBA,UAAtB;IAEAgB,KAAK,CAACV,MAAN,CAAa;MACXyB,KAAK,EAAEJ,QAAQ,CAACI,KADL;MAEXC,MAAM,EAAEL,QAAQ,CAACK,MAFN;MAGXT,GAAG,EAAHA,GAHW;MAIXK,UAAU,EAAVA,UAJW;MAKXK,OAAO,EAAEN,QAAQ,CAACM,OALP;MAMXC,SAAS,EAAEP,QAAQ,CAACO;IANT,CAAb;IASAX,GAAG,CAACY,OAAJ;EACD;EAED,OACEzC,KAAA,CAAA0C,aAAA;IACEC,GAAG,EAAElB,YADP;IAEEY,KAAK,EAAEJ,QAAQ,CAACI,KAAT,GAAiB/B,UAF1B;IAGEgC,MAAM,EAAEL,QAAQ,CAACK,MAAT,GAAkBhC,UAH5B;IAIEsC,KAAK,EAAE;MACLP,KAAK,KAAAQ,MAAA,CAAKZ,QAAQ,CAACI,KAAd,OADA;MAELC,MAAM,KAAAO,MAAA,CAAKZ,QAAQ,CAACK,MAAd,OAFD;MAGLQ,QAAQ,EAAE,UAHL;MAILC,IAAI,EAAE,CAJD;MAKLC,GAAG,EAAE;IALA;EAJT,EADF;AAcD;AAED3B,aAAa,CAACZ,SAAd,GAA0BA,SAA1B;AACAY,aAAa,CAACN,YAAd,GAA6BA,YAA7B;AAEA,eAAeM,aAAf"},"metadata":{},"sourceType":"module"}